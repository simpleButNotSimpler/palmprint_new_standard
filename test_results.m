n = [0             0     33000         0  17964000;
    0.05          0     33000         0  17964000;
    0.1           0     33000         0  17964000;
    0.15          2     32998         0  17964000;
    0.2        1399     31601         0  17964000;
    0.25      19430     13570         0  17964000;
    0.255     21669     11331         1  17963999;
    0.257     22527     10473         1  17963999;
    0.260     23767      9233         1  17963999;
    0.263     24871      8129         2  17963998;
    0.265     25579      7421         3  17963997;
    0.267     26262      6738         9  17963991;
    0.27      27125      5875        19  17963981;
    0.29      31087      1913      3479  17960521;
    0.30      32095       905     22927  17941073;
    0.32      32814       186    387973  17576027;
    0.34      32971        29   2434485  15529515;
    0.4       33000         0  16694267   1269733;
    0.5       33000         0  17964000         0;
    0.6       33000         0  17964000         0;
    0.7       33000         0  17964000         0;
    0.8       33000         0  17964000         0;
    0.9       33000         0  17964000         0];

error = n(4:end, 1);
n = n(4:end,2:end);

tp = 100*n(:, 1) ./ (n(:, 1) + n(:, 3));
fp = 100*n(:, 3) ./ (n(:, 1) + n(:, 3));
fn = 100*n(:, 2) ./ (n(:, 2) + n(:, 4));
tn = 100*n(:, 4) ./ (n(:, 2) + n(:, 4));

subplot(1,3,1), plot(error, fn, 'r', error, fp, 'b')
xlabel('threshold')
ylabel('error rate (%)')
title('Red channel')

 tann_red = [error, tp, fn, fp, tn]
%% ======================================================
%======================================================
%======================================================


n = [0         0     33000         0  17964000;
    0.500         0     33000         0  17964000;
    0.100         0     33000         0  17964000;
    0.150        15     32985         0  17964000;
    0.200      3913     29087         0  17964000;
    0.250     23628      9372         0  17964000;
    0.255     25427      7573         1  17963999;
    0.257     26098      6902         2  17963998;
    0.260     27003      5997         2  17963998;
    0.265     28325      4675        26  17963974;
    0.267     28769      4231        54  17963946;
    0.270     29440      3560       128  17963872;
    0.290     32089       911     11858  17952142;
    0.300     32574       426     65642  17898358;
    0.320     32935        65    791569  17172431;
    0.340     32996         4   3876413  14087587;
    0.400     33000         0  17407386    556614;
    0.500     33000         0  17964000         0;
    0.600     33000         0  17964000         0;
    0.700     33000         0  17964000         0;
    0.800     33000         0  17964000         0;
    0.900     33000         0  17964000         0];

error = n(4:end, 1);
n = n(4:end,2:end);

tp = 100*n(:, 1) ./ (n(:, 1) + n(:, 3));
fp = 100*n(:, 3) ./ (n(:, 1) + n(:, 3));
fn = 100*n(:, 2) ./ (n(:, 2) + n(:, 4));
tn = 100*n(:, 4) ./ (n(:, 2) + n(:, 4));

subplot(1,3,2), plot(error, fn, 'r', error, fp, 'b')
xlabel('threshold')
ylabel('error rate (%)')
title('Green channel')



tann_green = [error, tp, fn, fp, tn]
%% ======================================================
%======================================================
%======================================================


n = [0         0     33000         0  17964000;
    0.500         0     33000         0  17964000;
    0.100         0     33000         0  17964000;
    0.150       299     32701         0  17964000;
    0.200      8956     24044         0  17964000;
    0.250     26410      6590         0  17964000;
    0.255     27613      5387         0  17964000;
    0.257     28051      4949         0  17964000;
    0.260     28651      4349         0  17964000;
    0.265     29611      3389         5  17963995;
    0.267     29942      3058        11  17963989;
    0.270     30370      2630        23  17963977;
    0.290     32163       837      3564  17960436;
    0.300     32576       424     22148  17941852;
    0.320     32899       101    337815  17626185;
    0.340     32986        14   2004641  15959359;
    0.400     33000         0  16109656   1854344;
    0.500     33000         0  17963999         1;
    0.600     33000         0  17964000         0;
    0.700     33000         0  17964000         0;
    0.800     33000         0  17964000         0;
    0.900     33000         0  17964000         0];

error = n(4:end, 1);
n = n(4:end,2:end);

tp = 100*n(:, 1) ./ (n(:, 1) + n(:, 3));
fp = 100*n(:, 3) ./ (n(:, 1) + n(:, 3));
fn = 100*n(:, 2) ./ (n(:, 2) + n(:, 4));
tn = 100*n(:, 4) ./ (n(:, 2) + n(:, 4));

subplot(1,3,3), plot(error, fn, 'r', error, fp, 'b')
xlabel('threshold')
ylabel('error rate (%)')
title('Blue channel')

tann_blue = [error, tp, fn, fp, tn]